On System#Boot do
  gpio,15,0 //D8
endon

//On garage#relay do
   if [garage#relay]=1
    pulse,15,1,200
    Publish status,gpio,15 to [%sysname%/Garage/status]
    gpio,15,0
   endif
//endon 

On garage#relay do
  if [garage#relay] > 2000
     gpio,15,0
  endif
endon  
 //if else needed for garage#door=1 > 1000
   //publish /MyHome/Garage/, RELAY FAULT - URGENT

//on Garage#Reed do
// if [Garage#Reed] = 1
//  GPIO,13,1
//  else 
//  GPIO,13,0
// endif
//endon


rule set 2

on sniff#cmdMQTT=1 do
  Publish %sysname%/IP,%ip% // I am alive and this is my address
endon


on sniff#cmdMQTT=2 do
  Publish %sysname%/Time,%systime% //The current time on this device will published to cmdMQTT/TIME/
endon                                                       // possible to adjust time if not using NTP?

on sniff#cmdMQTT=3 do
 Publish %sysname%/status,Rebooting   //set a non focused reboot to multiple devices.
 Reboot
endon

on sniff#cmd/REBOOT/time/=4 do   //reboot at the time based on persistence on broker?
  Publish %sysname%/status,Rebooting 
 Reboot
endon
